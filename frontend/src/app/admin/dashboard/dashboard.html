<div class="dashboard-container fade-in-up">
  <h2 class="text-gradient section-title">Admin Dashboard</h2>

  @if (!stats()) {
    <div class="loading-state">
      <p>Chargement des statistiques...</p>
    </div>
  } 
  @else {
    <div class="stats-grid">
      <div class="stat-card users-card" routerLink="/admin/users">
        <div class="stat-icon">üë•</div>
        <div class="stat-content">
          <h3>Total Users</h3>
          <p class="stat-number">{{ stats()?.overview?.totalUsers }}</p>
        </div>
      </div>

      <div class="stat-card events-card" routerLink="/events">
        <div class="stat-icon">üìÖ</div>
        <div class="stat-content">
          <h3>Total Events</h3>
          <p class="stat-number">{{ stats()?.overview?.totalEvents }}</p>
        </div>
      </div>

      <div class="stat-card pending-card" routerLink="/admin/approvals">
        <div class="stat-icon">‚è≥</div>
        <div class="stat-content">
          <h3>Pending Reviews</h3>
          <p class="stat-number">{{ stats()?.overview?.pendingEvents }}</p>
        </div>
      </div>
    </div>

    <div class="charts-section">
      
      <div class="chart-container">
        <h3>Statuts d'approbation</h3>
        <div class="canvas-wrapper pie-wrapper">
          <canvas baseChart
            [data]="pieChartData()"
            [type]="'pie'"
            [options]="pieChartOptions">
          </canvas>
        </div>
      </div>

      <div class="chart-container">
        <h3>Top des Salles</h3>
        <div class="canvas-wrapper bar-wrapper">
          @if (roomChartData().labels && roomChartData().labels!.length > 0) {
            <canvas baseChart 
                [data]="roomChartData()" 
                [options]="barChartOptions" 
                [type]="'bar'">
            </canvas>
          } @else {
            <p class="no-data">Aucune donn√©e de salle.</p>
          }
        </div>
      </div>
    </div>
  <div class="recent-activity-container">
  <h3>üïë Activit√© R√©cente</h3>
  
  <div class="activity-list">
    @for (event of recentActivity(); track event.id) {
      <div class="activity-item">
        
        <div class="activity-icon" [ngClass]="event.approvalStatus">
          @if(event.approvalStatus === 'approved') { <i class="fas fa-check"></i> }
          @else if(event.approvalStatus === 'rejected') { <i class="fas fa-times"></i> }
          @else { <i class="fas fa-clock"></i> }
        </div>

        <div class="activity-details">
          <p class="activity-text">
            <strong>{{ event.organizer?.user?.firstName || 'Un utilisateur' }} {{event.organizer?.user?.lastName}}</strong> 
            a demand√© :
            <strong>{{ event.location }}</strong>
          </p>
          <p class="activity-subtext">
            {{ event.title }} ‚Ä¢ {{ event.createdAt | date:'dd/MM/yyyy √† HH:mm' }}
          </p>
        </div>

        <div class="status-badge-mini" [ngClass]="event.approvalStatus">
          {{ event.approvalStatus }}
        </div>
      </div>
    } @empty {
      <p class="no-data">Aucune activit√© r√©cente.</p>
    }
  </div>
</div>
  }
</div>